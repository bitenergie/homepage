---
import NumberInput from "~/components/ui/NumberInput.astro";
---

<div class="max-w-fit rounded-lg shadow-lg my-4 px-6 py-4 dark:bg-slate-800">
  <p class="text-3xl font-bold mb-3 dark:text-slate-300">Kvs</p>
  <NumberInput label="kv [m3/h]" name="dfa" id="kvs_kv" value="10" />
  <NumberInput label="massflow [m3/h]" name="dfa" id="kvs_q" value="3" />
  <NumberInput label="delta p [kPa]" name="dfa" id="kvs_dp" value="9" />
</div>

<script>
  function massflow(e) {
    console.log(e.target.value, e.target.id);
    if (e.target.id == "kvs_kv") {
      kvs_dp.value = parseFloat(
        (1 / Math.pow((e.target.value / kvs_q.value), 2)*100) 
      ).toFixed(2);
    }
    if (e.target.id == "kvs_q") {
      kvs_dp.value = parseFloat(
      (1 / Math.pow((kvs_kv.value / e.target.value), 2)*100) 
      ).toFixed(2);
    }
    if (e.target.id == "kvs_dp") {
      kvs_kv.value = parseFloat(
        (kvs_q.value * Math.floor((1/(kvs_dp.value/100))))
      ).toFixed(2);
    }

  }

  kvs_kv = document.getElementById("kvs_kv");
  kvs_q = document.getElementById("kvs_q");
  kvs_dp = document.getElementById("kvs_dp");
  
  kvs_kv.addEventListener("change", massflow);
  kvs_q.addEventListener("change", massflow);
  kvs_dp.addEventListener("change", massflow);
</script>
